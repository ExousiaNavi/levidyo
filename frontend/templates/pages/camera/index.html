{% extends "base.html" %} {% block content %}
<!-- Skeleton Loader -->
  <div id="skeleton-loader-container" class="w-full h-screen bg-white">
    <div
      id="skeleton-loader"
      class="grid grid-cols-1 lg:grid-cols-2 gap-4 animate-pulse p-4"
    >
      <!-- Left: Deposit Overview Placeholder -->
      <div class="space-y-4">
        <!-- Title Placeholder -->
        <div class="h-6 w-1/3 bg-gray-300 rounded"></div>

        <!-- KPI Cards -->
        <div class="grid grid-cols-3 gap-3">
          <div class="h-24 bg-gray-200 rounded-lg"></div>
          <div class="h-24 bg-gray-200 rounded-lg"></div>
          <div class="h-24 bg-gray-200 rounded-lg"></div>
        </div>

        <!-- Deposit Log Placeholder -->
        <div class="h-[calc(100vh-250px)] bg-gray-200 rounded-lg"></div>
      </div>

      <!-- Right: Charts Placeholder -->
      <div class="space-y-4">
        <div
          class="h-64 bg-gray-200 rounded-lg flex flex-col justify-center items-center"
        >
          <div class="h-6 w-1/4 bg-gray-300 rounded mb-2"></div>
          <div class="h-40 w-11/12 bg-gray-300 rounded"></div>
        </div>
        <div
          class="h-64 bg-gray-200 rounded-lg flex flex-col justify-center items-center"
        >
          <div class="h-6 w-1/4 bg-gray-300 rounded mb-2"></div>
          <div class="h-40 w-11/12 bg-gray-300 rounded"></div>
        </div>
      </div>
    </div>
  </div>
<!-- Main Dashboard Grid -->
<div
id="mdh"
  class="grid grid-cols-1 lg:grid-cols-2 gap-4 p-0 md:p-4 w-full items-stretch min-h-[calc(100vh-100px)] hidden"
>
  
  <!-- üî¥ Live Camera Feed Section -->
  <div
    class="flex flex-col p-1 md:p-6 bg-white rounded-2xl shadow-lg border border-gray-200 h-full"
  >
    <div class="flex items-center justify-center gap-2 mb-4 w-full">
      <i data-lucide="camera" class="w-6 h-6 text-blue-600"></i>
      <h2 class="text-2xl font-semibold text-gray-800">Live Camera Feed</h2>
    </div>

    <div
      class="relative w-full max-w-[360px] mx-auto h-[480px] sm:h-full border rounded-xl overflow-hidden bg-black border border-gray-300 shadow-sm"
    >
      <video
        id="video"
        class="absolute top-0 left-0 w-full h-full object-cover z-10"
        autoplay
        playsinline
        muted
      ></video>
      <canvas
        id="overlay"
        class="absolute top-0 left-0 w-full h-full z-20"
      ></canvas>
    </div>

    <canvas id="canvas" width="320" height="240" class="hidden"></canvas>

    <button
      disabled
      id="capture"
      class="mt-2 w-full px-6 py-3 bg-green-600 text-white rounded-xl text-lg font-semibold shadow hover:bg-green-700 hover:scale-105 active:scale-95 transition-transform duration-200"
    >
      Capture
    </button>
  </div>

  <!-- üü¢ Encoded Image Gallery Section -->
  <div
    class="flex flex-col p-6 bg-white rounded-2xl shadow-lg border border-gray-200 h-full"
  >
    <div class="flex items-center gap-2 mb-4">
      <i data-lucide="image-down" class="w-6 h-6 text-green-600"></i>
      <h2 class="text-2xl font-semibold text-gray-800">
        Encoded Image Gallery
      </h2>
    </div>

    <span class="text-sm text-red-600 mb-2">For Testing</span>

    <div
      id="encodedGalleryWrapper"
      class="max-h-[300px] overflow-y-auto border border-gray-300 rounded-xl p-3 bg-gray-50 shadow-inner"
    >
      <div
        id="encodedGallery"
        class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4"
      >
        <!-- thumbnails inserted here -->
      </div>
    </div>

    <button
      id="decodeBtnGallery"
      class="hidden w-full px-6 py-3 mt-6 bg-green-600 text-white rounded-xl text-lg font-semibold shadow hover:bg-green-700 hover:scale-105 active:scale-95 transition-transform duration-200"
    >
      üîç Decode Selected Image
    </button>

    <p
      id="decodedMessageGallery"
      class="text-center mt-4 text-base text-gray-800 font-mono break-words whitespace-pre-wrap px-2"
    ></p>
  </div>
</div>

<!-- Scrollbar + Thumbnail Hover Effects -->
<style>
  #encodedGalleryWrapper::-webkit-scrollbar {
    width: 6px;
  }
  #encodedGalleryWrapper::-webkit-scrollbar-thumb {
    background-color: rgba(100, 100, 100, 0.2);
    border-radius: 4px;
  }
  #encodedGallery img {
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }
  #encodedGallery img:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }
  #encodedGallery img:active {
    transform: scale(0.95);
  }
 #video,
#overlay {
  width: 100%;
  max-width: 360px;
  aspect-ratio: 3 / 4;
  object-fit: cover;
  display: block;
  margin: 0 auto;
  border-radius: 1rem;
}


</style>

<!-- ‚úÖ Face + Camera Scripts -->
<script defer src="/static/js/face-api.js"></script>
<script defer src="/static/js/camera.js"></script>
{% endblock %}
