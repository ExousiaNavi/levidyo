<div
  id="kyc_not_verified"
  class="flex flex-col items-center justify-center bg-white rounded-2xl shadow-xl w-full max-w-xl mx-auto p-2 md:p-10 hidden transition duration-300 ease-in-out"
>
  <!-- Progress Bar -->
  <div class="flex justify-between items-center mb-8">
    <div id="step1" class="flex-1 h-1 bg-green-500 rounded"></div>
    <div id="step2" class="flex-1 h-1 bg-gray-200 rounded ml-2"></div>
    <div id="step3" class="flex-1 h-1 bg-gray-200 rounded ml-2"></div>
    <div id="step4" class="flex-1 h-1 bg-gray-200 rounded ml-2"></div>
    <div id="step5" class="flex-1 h-1 bg-gray-200 rounded ml-2"></div>
    <div id="step6" class="flex-1 h-1 bg-gray-200 rounded ml-2"></div>
  </div>

  <!-- STEP 1 -->
  <div id="stepOne" class="step max-w-md mx-auto">
    <h2 class="text-3xl font-extrabold text-green-700 mb-2 text-center">
      Identity Verification
    </h2>
    <p class="text-gray-500 text-center mb-8">
      Select your country and document type to begin verification.
    </p>

    <!-- Country Select with inline flags -->
    <div class="mb-6">
      <label class="block font-medium text-gray-700 mb-2"
        >Country of Residence</label
      >
      <div class="relative group flex items-center">
        <select
          id="country"
          class="w-full border border-gray-200 rounded-xl py-3.5 pl-14 pr-10 text-lg focus:ring-2 focus:ring-green-400 focus:border-green-400 focus:outline-none appearance-none bg-white shadow-sm transition-all"
        >
          <option value="">Select Country</option>
          {% for country in doc_types.values() %}
          <option value="{{ country.code }}" data-flag="{{ country.icon }}">
            {{ country.name }}
          </option>
          {% endfor %}
        </select>

        <!-- Left Flag Preview -->
        <div
          class="absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none"
        >
          <span
            id="country-flag"
            class="text-xl w-8 h-8 text-center flex items-center justify-center rounded-md bg-green-500 text-white"
          ></span>
        </div>

        <!-- Dropdown Arrow -->
        <div
          class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none"
        >
          <svg
            class="w-5 h-5 text-gray-400 transition-transform group-hover:translate-y-0.5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 9l-7 7-7-7"
            ></path>
          </svg>
        </div>
      </div>
    </div>

    <!-- Document Type Select -->
    <div class="mb-8">
      <label class="block font-medium text-gray-700 mb-2">Document Type</label>
      <div class="relative group">
        <!-- Left Icon (Lucide) -->
        <div
          class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none"
        >
          <span
            class="bg-green-500 rounded-md w-8 h-8 flex items-center justify-center"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="lucide lucide-file-text w-5 h-5 text-white"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
              />
              <polyline points="14 2 14 8 20 8" />
              <line x1="16" x2="8" y1="13" y2="13" />
              <line x1="16" x2="8" y1="17" y2="17" />
              <line x1="10" x2="8" y1="9" y2="9" />
            </svg>
          </span>
        </div>

        <!-- Select Element -->
        <select
          id="documentType"
          class="w-full border border-gray-200 rounded-xl py-3.5 pl-14 pr-10 text-lg focus:ring-2 focus:ring-green-400 focus:border-green-400 focus:outline-none appearance-none bg-white shadow-sm transition-all"
          disabled
        >
          <option value="">Select Document Type</option>
        </select>

        <!-- Right Dropdown Arrow -->
        <div
          class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none"
        >
          <svg
            class="w-5 h-5 text-gray-400 transition-transform group-hover:translate-y-0.5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 9l-7 7-7-7"
            ></path>
          </svg>
        </div>
      </div>
    </div>

    <!-- Next Button -->
    <button
      id="nextToStep2"
      class="bg-green-500 px-8 py-3.5 rounded-xl w-full font-bold text-white text-lg hover:bg-green-600 transition-all disabled:opacity-50 shadow-md hover:shadow-lg active:scale-[0.98]"
      disabled
    >
      Continue
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-5 w-5 inline ml-1 -mr-1"
        viewBox="0 0 20 20"
        fill="currentColor"
      >
        <path
          fill-rule="evenodd"
          d="M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z"
          clip-rule="evenodd"
        />
      </svg>
    </button>
  </div>

  <!-- Orientation Guide Popup -->
  <div
    id="orientationGuide"
    class="hidden fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4 backdrop-blur-sm"
  >
    <div
      class="bg-white rounded-xl max-w-md w-full mx-4 shadow-2xl transform transition-all duration-300 scale-95 animate-fade-in"
    >
      <div class="p-6">
        <!-- Header -->
        <div class="flex justify-center items-center mb-4">
          <h3 class="text-xl font-bold text-green-600">
            <span id="guideSideText">Front Side</span> Position
          </h3>
        </div>

        <!-- Content -->
        <div class="space-y-6">
          <!-- Card Visualization -->
          <div
            class="relative mx-auto w-full h-[290px] flex items-center justify-center"
          >
            <!-- Animated Card -->
            <div
              id="animatedCard"
              class="relative origin-center transition-transform duration-1000 ease-in-out"
            >
              <div
                class="bg-white border-2 border-gray-200 rounded-lg p-4 h-[150px] w-[250px] shadow-sm"
              >
                <!-- Front Side Content -->
                <div
                  id="frontGuideContent"
                  class="h-full flex flex-col justify-between"
                >
                  <div class="flex justify-between">
                    <div class="h-4 w-20 bg-gray-100 rounded"></div>
                    <div class="h-4 w-12 bg-gray-100 rounded"></div>
                  </div>
                  <div class="h-6 w-full bg-gray-100 rounded mt-4"></div>
                  <div class="flex justify-between mt-6">
                    <div class="space-y-1">
                      <div class="h-2 w-16 bg-gray-100 rounded"></div>
                      <div class="h-4 w-24 bg-gray-200 rounded"></div>
                    </div>
                    <div class="space-y-1">
                      <div class="h-2 w-16 bg-gray-100 rounded"></div>
                      <div class="h-4 w-16 bg-gray-200 rounded"></div>
                    </div>
                  </div>
                </div>

                <!-- Back Side Content -->
                <div
                  id="backGuideContent"
                  class="hidden h-full flex flex-col justify-between"
                >
                  <div class="h-4 w-full bg-gray-100 rounded"></div>
                  <div class="h-10 w-full bg-gray-200 rounded mt-2"></div>
                  <div class="flex justify-end">
                    <div class="h-4 w-12 bg-gray-100 rounded mt-4"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Instructions -->
          <ul class="space-y-3 text-sm text-gray-600">
            <li class="flex items-start gap-3 p-2 bg-gray-50 rounded-lg">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="text-green-500 mt-0.5"
              >
                <polyline points="6 9 12 15 18 9"></polyline>
              </svg>
              <span
                >Rotate card
                <strong class="text-green-600">90¬∞ to the right</strong></span
              >
            </li>
            <li class="flex items-start gap-3 p-2 bg-gray-50 rounded-lg">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="text-green-500 mt-0.5"
              >
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
              </svg>
              <span>Keep entire card within the frame</span>
            </li>
            <li class="flex items-start gap-3 p-2 bg-gray-50 rounded-lg">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="text-green-500 mt-0.5"
              >
                <circle cx="12" cy="12" r="5"></circle>
                <line x1="12" y1="1" x2="12" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="23"></line>
                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                <line x1="1" y1="12" x2="3" y2="12"></line>
                <line x1="21" y1="12" x2="23" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
              </svg>
              <span>Ensure good lighting with no glare</span>
            </li>
          </ul>
        </div>

        <!-- Action Button -->
        <button
          id="gotItBtn"
          class="mt-6 w-full py-3 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition shadow-md"
        >
          I Understand
        </button>
      </div>
    </div>
  </div>

  <!-- STEP 2 -->
  <div id="stepTwo" class="step hidden w-full">
    <h2 class="text-3xl font-extrabold text-green-700 mb-2 text-center">
      Capture Your Front ID
    </h2>
    <p class="text-gray-500 text-center mb-8">
      Please capture the front of your selected ID.
    </p>

    <!-- Front Side -->
    <div class="mb-6">
      <!-- ID Capture Page -->
      <div
        id="idCapturePage"
        class="w-full max-w-2xl bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"
      >
        <div class="px-6 pt-6 pb-4 border-b border-gray-100">
          <h2 id="idCaptureTitle" class="text-lg font-medium text-gray-900">
            ID Document Capture
          </h2>
          <p class="text-sm text-gray-500 mt-1">
            Position your ID within the frame
          </p>
        </div>

        <div class="p-6">
          <div
            class="relative w-full max-w-md mx-auto aspect-[3/4] bg-gray-900 rounded-lg overflow-hidden"
          >
            <div id="camera-id-wrapper" class="relative w-full h-full">
              <video
                id="idVideo"
                class="absolute inset-0 w-full h-full object-cover z-10"
                autoplay
                playsinline
                muted
              ></video>
              <canvas
                id="idOverlay"
                class="absolute inset-0 z-20 w-full h-full"
              ></canvas>
            </div>
          </div>

          <canvas id="idCanvas" class="hidden"></canvas>

          <div class="mt-4 flex justify-between items-center">
            <button
              id="captureIdFront"
              class="px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md hover:bg-green-700 transition-colors"
            >
              Capture Document
            </button>
          </div>
        </div>
      </div>

      <!-- id front Preview -->
      <div
        id="frontIdPreviewPage"
        class="hidden w-full max-w-2xl bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden"
      >
        <!-- Header -->
        <div class="px-6 pt-6 pb-4 border-b border-gray-100">
          <h2 class="text-lg font-semibold text-gray-900">Front ID Preview</h2>
          <p class="text-sm text-gray-500 mt-1">
            Review your captured photo before proceeding
          </p>
        </div>

        <!-- Image Preview -->
        <div class="relative p-6">
          <img
            id="frontIdPreviewImage"
            class="rounded-lg border border-gray-200 w-full object-contain mx-auto"
          />

          <!-- Floating Buttons -->
          <button
            id="tryAgainFontId"
            class="absolute top-10 left-10 p-2 bg-gray-800/50 rounded-md shadow-md hover:bg-gray-900 transition-all flex items-center justify-center"
            title="Retake"
          >
            <i data-lucide="rotate-ccw" class="w-5 h-5 text-white"></i>
          </button>

          <button
            id="continueFrontId"
            class="hidden absolute top-10 right-10 p-2 bg-gray-800/50 rounded-md shadow-md hover:bg-gray-900 transition-all flex items-center justify-center"
            title="Continue"
          >
            <i data-lucide="check" class="w-5 h-5 text-green-500"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Navigation Buttons -->
    <div class="flex gap-4">
      <button
        id="backToStep1"
        class="bg-gray-100 px-8 py-4 rounded-xl w-1/2 font-bold text-lg hover:bg-gray-200 transition shadow-sm"
      >
        ‚Üê Back
      </button>
      <button
        id="nextToStep3"
        class="bg-green-500 px-8 py-4 rounded-xl w-1/2 font-bold text-lg text-white hover:bg-green-600 transition shadow-md disabled:opacity-50"
        disabled
      >
        Next ‚Üí
      </button>
    </div>
  </div>

  <!-- STEP 3 -->
  <div id="stepThree" class="step hidden w-full">
    <h2 class="text-3xl font-extrabold text-green-700 mb-2 text-center">
      Capture Your Back ID
    </h2>
    <p class="text-gray-500 text-center mb-8">
      Please capture the back of your selected ID.
    </p>

    <!-- Front Side -->
    <div class="mb-6">
      <!-- ID Capture Page -->
      <div
        id="idBackCapturePage"
        class="w-full max-w-2xl bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"
      >
        <div class="px-6 pt-6 pb-4 border-b border-gray-100">
          <h2 id="idBackCaptureTitle" class="text-lg font-medium text-gray-900">
            ID Document Capture
          </h2>
          <p class="text-sm text-gray-500 mt-1">
            Position your ID within the frame
          </p>
        </div>

        <div class="p-6">
          <div
            class="relative w-full max-w-md mx-auto aspect-[3/4] bg-gray-900 rounded-lg overflow-hidden"
          >
            <div id="camera-id-back-wrapper" class="relative w-full h-full">
              <video
                id="idBackVideo"
                class="absolute inset-0 w-full h-full object-cover z-10"
                autoplay
                playsinline
                muted
              ></video>
              <canvas
                id="idBackOverlay"
                class="absolute inset-0 z-20 w-full h-full"
              ></canvas>
            </div>
          </div>

          <canvas id="idBackCanvas" class="hidden"></canvas>

          <div class="mt-4 flex justify-between items-center">
            <button
              id="captureIdBack"
              class="px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md hover:bg-green-700 transition-colors"
            >
              Capture Document
            </button>
          </div>
        </div>
      </div>

      <!-- id front Preview -->
      <div
        id="backIdPreviewPage"
        class="hidden w-full max-w-2xl bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden"
      >
        <!-- Header -->
        <div class="px-6 pt-6 pb-4 border-b border-gray-100">
          <h2 class="text-lg font-semibold text-gray-900">Back ID Preview</h2>
          <p class="text-sm text-gray-500 mt-1">
            Review your captured photo before proceeding
          </p>
        </div>

        <!-- Image Preview -->
        <div class="relative p-6">
          <img
            id="backIdPreviewImage"
            class="rounded-lg border border-gray-200 w-full max-h-[70vh] object-contain mx-auto"
          />

          <!-- Floating Buttons -->
          <button
            id="tryAgainBackId"
            class="absolute top-10 left-10 p-2 bg-gray-800/50 rounded-md shadow-md hover:bg-gray-900 transition-all flex items-center justify-center"
            title="Retake"
          >
            <i data-lucide="rotate-ccw" class="w-5 h-5 text-white"></i>
          </button>

          <button
            id="continueBackId"
            class="hidden absolute top-10 right-10 p-2 bg-gray-800/50 rounded-md shadow-md hover:bg-gray-900 transition-all flex items-center justify-center"
            title="Continue"
          >
            <i data-lucide="check" class="w-5 h-5 text-green-500"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Navigation Buttons -->
    <div class="flex gap-4">
      <button
        id="backToStep2"
        class="bg-gray-100 px-8 py-4 rounded-xl w-1/2 font-bold text-lg hover:bg-gray-200 transition shadow-sm"
      >
        ‚Üê Back
      </button>
      <button
        id="nextToStep4"
        class="bg-green-500 px-8 py-4 rounded-xl w-1/2 font-bold text-lg text-white hover:bg-green-600 transition shadow-md disabled:opacity-50"
        disabled
      >
        Next ‚Üí
      </button>
    </div>
  </div>

  <!-- Capture Loader -->
  <div
    id="captureLoader"
    class="hidden fixed inset-0 flex items-center justify-center bg-black/90 bg-opacity-50 backdrop-blur-sm z-50"
  >
    <div class="bg-white rounded-lg shadow-xl p-6 max-w-sm w-full">
      <div class="flex items-center space-x-3">
        <div
          class="w-5 h-5 border-2 border-green-600 border-t-transparent rounded-full animate-spin"
        ></div>
        <p class="text-sm font-medium text-gray-900">
          Processing your photo...
        </p>
      </div>
      <p class="text-xs text-gray-500 mt-2 ml-8">
        This usually takes a second to process.
      </p>
    </div>
  </div>

  <!-- Success Message -->
  <div
    id="successLoader"
    class="hidden fixed inset-0 flex items-center justify-center bg-black/90 backdrop-blur-sm z-50"
  >
    <div class="bg-white rounded-lg shadow-xl p-6 max-w-sm w-full text-center">
      <!-- Success Checkmark -->
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="w-10 h-10 text-green-600 mx-auto"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
        stroke-width="2"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M5 13l4 4L19 7"
        />
      </svg>

      <!-- Message -->
      <p class="text-green-600 font-semibold mt-3 text-lg">Success!</p>
      <p class="text-xs text-gray-500 mt-1">
        Your photo has been processed successfully.
      </p>
    </div>
  </div>

  <!-- Error Message -->
  <div
    id="errorLoader"
    class="hidden fixed inset-0 flex items-center justify-center bg-black/90 backdrop-blur-sm z-50"
  >
    <div class="bg-white rounded-lg shadow-xl p-6 max-w-sm w-full text-center">
      <!-- Error Cross Icon -->
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="w-10 h-10 text-red-600 mx-auto"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
        stroke-width="2"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M6 18L18 6M6 6l12 12"
        />
      </svg>

      <!-- Message -->
      <p class="text-red-600 font-semibold mt-3 text-lg">Validation Error!</p>
      <p class="text-xs text-gray-500 mt-1">
        Please position the ID or your face fully inside the guide box, centered
        and clearly visible, before taking the photo.
      </p>
    </div>
  </div>

  <!-- Camera Error Message -->
  <div
    id="cameraError"
    class="hidden fixed inset-0 flex items-center justify-center bg-black/90 backdrop-blur-sm z-50"
  >
    <div class="bg-white rounded-lg shadow-xl p-6 max-w-sm w-full text-center">
      <!-- Error Cross Icon -->
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="w-10 h-10 text-red-600 mx-auto"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
        stroke-width="2"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M6 18L18 6M6 6l12 12"
        />
      </svg>

      <!-- Main Error Message -->
      <p class="text-red-600 font-semibold mt-3 text-lg">Camera Error!</p>

      <!-- Detailed Message -->
      <p class="text-xs text-gray-500 mt-1">
        Unable to access your camera. Please make sure you‚Äôve granted permission
        and have a working camera connected.
        <br />
        <strong>Note:</strong> Only the
        <span class="text-red-500">back camera</span> is supported. If you have
        multiple cameras, ensure the correct one is selected.
      </p>

      <!-- Retry Button -->
      <button
        id="retryCameraBtn"
        class="mt-4 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg shadow"
      >
        Retry
      </button>
    </div>
  </div>

  <!-- Face Capture Guide Popup -->
  <div
    id="faceGuide"
    class="hidden fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4 backdrop-blur-sm"
  >
    <div
      class="bg-white rounded-xl max-w-md w-full mx-4 shadow-2xl transform transition-all duration-300 scale-95 animate-fade-in"
    >
      <div class="p-6">
        <!-- Header -->
        <div class="flex justify-center items-center mb-4">
          <h3 class="text-xl font-bold text-green-600">Face Capture Guide</h3>
        </div>

        <div class="space-y-6">
          <!-- Face Visualization -->
          <div
            class="relative mx-auto w-[180px] h-[240px] flex items-center justify-center"
          >
            <!-- Portrait-oriented Oblong Frame -->
            <div
              class="border-2 border-green-300/80 p-2 flex items-center justify-center"
              style="border-radius: 60% / 50%; width: 160px; height: 190px"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                class="w-[7rem] h-[7rem] text-green-500"
                fill="none"
              >
                <path
                  d="M9 16C9.85038 16.6303 10.8846 17 12 17C13.1154 17 14.1496 16.6303 15 16"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                />
                <ellipse
                  cx="15"
                  cy="10.5"
                  rx="1"
                  ry="1.5"
                  fill="currentColor"
                />
                <ellipse cx="9" cy="10.5" rx="1" ry="1.5" fill="currentColor" />
                <path
                  opacity="0.5"
                  d="M2.19995 10.0002C2.99533 6.08188 6.08174 2.99551 10.0001 2.2002"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                />
                <path
                  opacity="0.5"
                  d="M2.2002 14C2.99557 17.9183 6.08198 21.0047 10.0003 21.8"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                />
                <path
                  opacity="0.5"
                  d="M21.8001 10.0002C21.0047 6.08188 17.9183 2.99551 14 2.2002"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                />
                <path
                  opacity="0.5"
                  d="M21.8001 14C21.0047 17.9183 17.9183 21.0047 14 21.8"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                />
              </svg>
            </div>

            <!-- Alignment Guides -->
            <div
              class="absolute inset-0 flex items-center justify-center pointer-events-none"
            >
              <div
                class="absolute inset-4 border border-dashed border-green-200/50 rounded-full"
                style="border-radius: 60% / 50%"
              ></div>
            </div>
          </div>

          <!-- Instructions -->
          <div class="space-y-2 text-sm text-gray-600">
            <div class="flex items-center gap-3 p-2 bg-gray-50 rounded-lg">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="text-green-500 flex-shrink-0"
              >
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
              </svg>
              <span>Center your face in the frame</span>
            </div>
            <div class="flex items-center gap-3 p-2 bg-gray-50 rounded-lg">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="text-green-500 flex-shrink-0"
              >
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M8 14s1.5 2 4 2 4-2 4-2"></path>
                <line x1="9" y1="9" x2="9.01" y2="9"></line>
                <line x1="15" y1="9" x2="15.01" y2="9"></line>
              </svg>
              <span>Keep neutral expression</span>
            </div>
            <div class="flex items-center gap-3 p-2 bg-gray-50 rounded-lg">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="text-green-500 flex-shrink-0"
              >
                <path
                  d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"
                ></path>
              </svg>
              <span>Ensure good lighting</span>
            </div>
            <div class="flex items-center gap-3 p-2 bg-gray-50 rounded-lg">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="text-green-500 flex-shrink-0"
              >
                <path d="M17 16.95A7 7 0 0 1 9.95 3L7 6"></path>
                <path d="M22 12A10 10 0 0 0 12 2v10z"></path>
              </svg>
              <span>Remove glasses if needed</span>
            </div>
          </div>
        </div>

        <!-- Action Button -->
        <button
          id="startFaceCaptureBtn"
          class="mt-6 w-full py-3 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition shadow-md"
        >
          Start Face Capture
        </button>
      </div>
    </div>
  </div>

  <div id="stepFour" class="step hidden w-full">
    <h2 class="text-3xl font-extrabold text-green-700 mb-2 text-center">
      Face Verification
    </h2>
    <p class="text-gray-500 text-center mb-8">
      Take a selfie to complete your verification.
    </p>

    <!-- <input
    id="selfieUpload"
    type="file"
    accept="image/*"
    class="w-full border rounded-lg p-3 mb-4"
    /> -->
    <!-- Camera Feed Section -->
    <div
      id="cameraPage"
      class="w-full max-w-2xl bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"
    >
      <input type="hidden" id="uploadedFilename" />
      <input type="hidden" id="uploadedFilenameIdFront" />
      <input type="hidden" id="uploadedFilenameIdBack" />

      <!-- Camera Header -->
      <div class="px-6 pt-6 pb-4 border-b border-gray-100">
        <h2 class="text-lg font-medium text-gray-900">Identity Verification</h2>
        <p class="text-sm text-gray-500 mt-1">
          Capture your face for verification
        </p>
      </div>

      <!-- Camera Container -->
      <div class="p-6">
        <div
          id="camera-container"
          class="relative w-full max-w-md mx-auto aspect-[3/4] bg-gray-900 rounded-lg overflow-hidden"
        >
          <!-- Camera Loading Indicator -->
          <div
            id="cameraLoading"
            class="absolute inset-0 flex items-center justify-center bg-gray-900 bg-opacity-80 z-30"
          >
            <div class="space-y-4 text-center">
              <div
                class="w-10 h-10 border-2 border-white border-t-transparent rounded-full animate-spin mx-auto"
              ></div>
              <p class="text-sm text-white">Initializing camera...</p>
            </div>
          </div>

          <!-- Camera Error State -->
          <div
            id="cameraError"
            class="hidden absolute inset-0 flex flex-col items-center justify-center bg-gray-900 bg-opacity-90 text-white p-6 z-40"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="text-gray-300 mb-3"
            >
              <circle cx="12" cy="12" r="10"></circle>
              <line x1="12" y1="8" x2="12" y2="12"></line>
              <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
            <p class="text-center text-gray-300">
              Camera access required. Please enable permissions to continue.
            </p>
            <button
              id="retryCamera"
              class="mt-4 px-4 py-2 bg-white text-gray-900 text-sm font-medium rounded-md hover:bg-gray-100 transition-colors"
            >
              Retry
            </button>
          </div>

          <!-- Camera Wrapper -->
          <div id="camera-wrapper" class="relative w-full h-full">
            <video
              id="video"
              class="absolute inset-0 object-cover w-full h-full z-10"
              autoplay
              playsinline
              muted
            ></video>
            <canvas
              id="overlay"
              class="absolute inset-0 z-20 w-full h-full"
            ></canvas>
          </div>
        </div>

        <canvas id="canvas" class="hidden"></canvas>

        <!-- Face Position Feedback -->
        <p
          id="face_position"
          class="text-center text-sm text-green-600 mt-3 h-5 mb-2"
        >
          Position your face inside the circle.
        </p>

        <div class="flex items-center justify-end hidden">
          <a
            id="faceUploadBtn"
            href="javascript:void(0)"
            class="border-b border-gray-300 text-gray-600 hover:text-gray-800"
          >
            Don't have a camera?
          </a>
        </div>
        <!-- Capture Button -->
        <button
          id="capture"
          disabled
          class="mt-4 w-full px-4 py-3 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700 transition-colors focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2"
        >
          Capture Photo
        </button>
      </div>

      <!-- üü¢ ADD THIS -->
      <div id="selfiePreviewContainer" class="mt-3 hidden text-center">
        <img
          id="selfieUploadPreview"
          class="w-32 h-32 object-cover rounded-full border shadow mx-auto"
        />
      </div>
    </div>

    <!-- Face Preview Page -->
    <div
      id="previewPage"
      class="hidden w-full max-w-2xl bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden"
    >
      <!-- Header -->
      <div class="px-6 pt-6 pb-4 border-b border-gray-100">
        <h2 class="text-lg font-semibold text-gray-900">Photo Preview</h2>
        <p class="text-sm text-gray-500 mt-1">
          Review your captured photo before proceeding
        </p>
      </div>

      <!-- Image Preview -->
      <div class="relative p-6">
        <img
          id="previewImage"
          class="rounded-lg border border-gray-200 w-full max-h-[70vh] object-contain mx-auto"
        />

        <!-- Floating Buttons -->
        <button
          id="tryAgain"
          class="absolute top-10 left-10 p-2 bg-gray-800/50 rounded-md shadow-md hover:bg-gray-900 transition-all flex items-center justify-center"
          title="Retake"
        >
          <i data-lucide="rotate-ccw" class="w-5 h-5 text-white"></i>
        </button>

        <button
          id="continueFaceBtn"
          class="hidden absolute top-10 right-10 p-2 bg-gray-800/50 rounded-md shadow-md hover:bg-gray-900 transition-all flex items-center justify-center"
          title="Continue"
        >
          <i data-lucide="check" class="w-5 h-5 text-green-500"></i>
        </button>
      </div>
    </div>

    <div class="flex gap-4 mt-4">
      <button
        id="backToStep3"
        class="bg-gray-200 px-8 py-4 rounded-lg w-1/2 font-bold hover:bg-gray-300 transition"
      >
        ‚Üê Back
      </button>
      <button
        id="nextToStep5"
        class="bg-green-500 text-white px-8 py-4 rounded-lg w-1/2 font-bold hover:bg-green-600 transition disabled:opacity-50"
        disabled
      >
        Next ‚Üí
      </button>
    </div>
  </div>

  <!-- STEP 5 -->
  <div id="stepFive" class="step hidden w-full">
    <h2 class="text-3xl font-extrabold text-green-700 mb-2 text-center">
      Personal Information
    </h2>
    <p class="text-gray-600 text-center mb-8">
      Fill in your details to complete verification.
    </p>

    <form id="personalInfoForm" class="space-y-6">
      <div>
        <label class="block text-green-800 font-semibold mb-2">Full Name</label>
        <input
          type="text"
          id="fullName"
          class="w-full border border-green-300 rounded-xl p-4 text-lg focus:outline-none focus:ring-2 focus:ring-green-500 bg-white shadow transition"
          placeholder="John Doe"
          required
        />
      </div>

      <div>
        <label class="block text-green-800 font-semibold mb-2">Birthdate</label>
        <input
          type="date"
          id="birthdate"
          class="w-full text-start border border-green-300 rounded-xl p-4 text-lg focus:outline-none focus:ring-2 focus:ring-green-500 bg-white shadow transition"
          required
        />
      </div>

      <div>
        <label class="block text-green-800 font-semibold mb-2">Address</label>
        <input
          type="text"
          id="address"
          class="w-full border border-green-300 rounded-xl p-4 text-lg focus:outline-none focus:ring-2 focus:ring-green-500 bg-white shadow transition"
          placeholder="123 Street Name"
          required
        />
      </div>

      <div>
        <label class="block text-green-800 font-semibold mb-2">City</label>
        <input
          type="text"
          id="city"
          class="w-full border border-green-300 rounded-xl p-4 text-lg focus:outline-none focus:ring-2 focus:ring-green-500 bg-white shadow transition"
          placeholder="City"
          required
        />
      </div>

      <div>
        <label class="block text-green-800 font-semibold mb-2"
          >Postal Code</label
        >
        <input
          type="text"
          id="postalCode"
          class="w-full border border-green-300 rounded-xl p-4 text-lg focus:outline-none focus:ring-2 focus:ring-green-500 bg-white shadow transition"
          placeholder="12345"
          required
        />
      </div>
    </form>

    <div class="flex gap-4 mt-10">
      <button
        id="backToStep4"
        class="bg-gray-200 px-8 py-4 rounded-lg w-1/2 font-bold hover:bg-gray-300 transition"
      >
        ‚Üê Back
      </button>
      <button
        id="nextToReview"
        class="bg-green-600 text-white px-6 py-3 rounded-xl w-1/2 font-semibold text-lg hover:bg-green-700 transition disabled:opacity-50"
        disabled
      >
        Next ‚Üí
      </button>
    </div>
  </div>

  <!-- FINAL REVIEW -->
  <div id="stepReview" class="step hidden w-full">
    <h2 class="text-3xl font-extrabold text-green-700 mb-2 text-center">
      Review Your Information
    </h2>

    <div class="bg-white p-6 sm:p-8 rounded-2xl shadow-lg border space-y-8">
      <!-- Personal Info -->
      <section>
        <h3 class="text-lg font-semibold text-gray-900 border-b pb-2 mb-4">
          Personal Details
        </h3>
        <dl class="grid grid-cols-1 sm:grid-cols-2 gap-x-8 gap-y-5">
          <div>
            <dt class="text-sm text-gray-500 uppercase">Country</dt>
            <dd
              id="reviewCountry"
              class="text-base font-medium text-gray-900"
            ></dd>
          </div>
          <div>
            <dt class="text-sm text-gray-500 uppercase">Document Type</dt>
            <dd
              id="reviewDocType"
              class="text-base font-medium text-gray-900"
            ></dd>
          </div>
          <div>
            <dt class="text-sm text-gray-500 uppercase">Full Name</dt>
            <dd
              id="reviewFullName"
              class="text-base font-medium text-gray-900"
            ></dd>
          </div>
          <div>
            <dt class="text-sm text-gray-500 uppercase">Birthdate</dt>
            <dd
              id="reviewBirthdate"
              class="text-base font-medium text-gray-900"
            ></dd>
          </div>
          <div class="sm:col-span-2">
            <dt class="text-sm text-gray-500 uppercase">Address</dt>
            <dd
              id="reviewAddress"
              class="text-base font-medium text-gray-900"
            ></dd>
          </div>
          <div>
            <dt class="text-sm text-gray-500 uppercase">City</dt>
            <dd
              id="reviewCity"
              class="text-base font-medium text-gray-900"
            ></dd>
          </div>
          <div>
            <dt class="text-sm text-gray-500 uppercase">Postal Code</dt>
            <dd
              id="reviewPostalCode"
              class="text-base font-medium text-gray-900"
            ></dd>
          </div>
        </dl>
      </section>

      <!-- ID Images -->
      <section>
        <h3 class="text-lg font-semibold text-gray-900 border-b pb-2 mb-4">
          Captured ID
        </h3>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
          <div
            class="relative w-full h-56 sm:h-64 rounded-xl overflow-hidden shadow-md border"
          >
            <img
              id="reviewFrontImg"
              class="absolute inset-0 w-full h-full object-cover"
            />
            <span
              class="absolute top-2 left-2 bg-green-500 text-white px-2 py-1 text-xs rounded"
              >Front</span
            >
          </div>
          <div
            class="relative w-full h-56 sm:h-64 rounded-xl overflow-hidden shadow-md border"
          >
            <img
              id="reviewBackImg"
              class="absolute inset-0 w-full h-full object-cover"
            />
            <span
              class="absolute top-2 left-2 bg-green-500 text-white px-2 py-1 text-xs rounded"
              >Back</span
            >
          </div>
        </div>
      </section>

      <!-- Selfie -->
      <section>
        <h3 class="text-lg font-semibold text-gray-900 border-b pb-2 mb-4">
          Selfie
        </h3>
        <div
          class="relative w-full aspect-square rounded-xl overflow-hidden shadow-md border bg-gray-50"
        >
          <img
            id="reviewSelfieImg"
            class="absolute inset-0 w-full h-full object-scale-down"
            onerror="this.src='placeholder-selfie.jpg'"
          />
        </div>
      </section>
    </div>

    <!-- Buttons -->
    <div class="flex flex-row items-center gap-4 mt-8">
      <button
        id="backToStep5"
        class="bg-gray-200 px-8 py-4 rounded-lg w-full sm:w-1/2 font-semibold hover:bg-gray-300 transition"
      >
        ‚Üê Back
      </button>
      <button
        id="submitKycFinal"
        class="bg-green-500 px-8 py-4 rounded-lg w-full sm:w-1/2 text-white font-semibold hover:bg-green-600 transition"
      >
        ‚úÖ Submit
      </button>
    </div>
  </div>

  <!-- UNDER REVIEW (Green Theme) -->
  <div
    id="kycUnderReview"
    class="hidden flex flex-col items-center justify-center bg-green-50 rounded-2xl shadow-xl w-full max-w-xl mx-auto p-10 text-center"
  >
    <svg
      class="w-20 h-20 text-green-500 mb-4"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      viewBox="0 0 24 24"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
      />
    </svg>
    <h2 class="text-2xl font-bold text-green-800 mb-2">KYC Under Review</h2>
    <p class="text-green-700 mb-6">
      Thank you for submitting your verification. Our team is reviewing your
      details. You will be notified once it‚Äôs approved.
    </p>
    <button
      id="backToDashboard"
      class="bg-green-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-green-700 transition"
    >
      ‚¨Ö Back to Dashboard
    </button>
  </div>
</div>
